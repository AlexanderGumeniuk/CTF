{% extends "base.html" %}
{% block content %}
<h1>Редактирование инцидента: {{ incident.title }}</h1>

<form method="POST">
    <label for="title">Название:</label>
    <input type="text" name="title" id="title" value="{{ incident.title }}" required>

    <label for="description">Описание:</label>
    <textarea name="description" id="description" required>{{ incident.description }}</textarea>

    <label for="incident_type">Тип инцидента:</label>
    <select name="incident_type" id="incident_type">
        <option value="Утечка данных" {% if incident.incident_type == 'Утечка данных' %}selected{% endif %}>Утечка данных</option>
        <option value="Фишинг" {% if incident.incident_type == 'Фишинг' %}selected{% endif %}>Фишинг</option>
        <option value="DDoS-атака" {% if incident.incident_type == 'DDoS-атака' %}selected{% endif %}>DDoS-атака</option>
        <option value="Вредоносное ПО" {% if incident.incident_type == 'Вредоносное ПО' %}selected{% endif %}>Вредоносное ПО</option>
        <option value="Другое" {% if incident.incident_type == 'Другое' %}selected{% endif %}>Другое</option>
    </select>

    <label for="severity_level">Уровень критичности:</label>
    <select name="severity_level" id="severity_level">
        <option value="Низкий" {% if incident.severity_level == 'Низкий' %}selected{% endif %}>Низкий</option>
        <option value="Средний" {% if incident.severity_level == 'Средний' %}selected{% endif %}>Средний</option>
        <option value="Высокий" {% if incident.severity_level == 'Высокий' %}selected{% endif %}>Высокий</option>
        <option value="Критический" {% if incident.severity_level == 'Критический' %}selected{% endif %}>Критический</option>
    </select>

    <label for="detection_time">Дата и время обнаружения:</label>
    <input type="datetime-local" name="detection_time" id="detection_time" value="{{ incident.detection_time.strftime('%Y-%m-%dT%H:%M') if incident.detection_time else '' }}">

    <label for="occurrence_time">Дата и время возникновения:</label>
    <input type="datetime-local" name="occurrence_time" id="occurrence_time" value="{{ incident.occurrence_time.strftime('%Y-%m-%dT%H:%M') if incident.occurrence_time else '' }}">

    <label for="source">Источник инцидента:</label>
    <select name="source" id="source">
        <option value="Внутренний источник" {% if incident.source == 'Внутренний источник' %}selected{% endif %}>Внутренний источник</option>
        <option value="Внешний источник" {% if incident.source == 'Внешний источник' %}selected{% endif %}>Внешний источник</option>
    </select>

    <label for="affected_systems">Затронутые системы или данные:</label>
    <textarea name="affected_systems" id="affected_systems">{{ incident.affected_systems }}</textarea>

    <label for="suspected_cause">Предполагаемая причина:</label>
    <textarea name="suspected_cause" id="suspected_cause">{{ incident.suspected_cause }}</textarea>

    <label for="actions_taken">Предпринятые действия:</label>
    <textarea name="actions_taken" id="actions_taken">{{ incident.actions_taken }}</textarea>

    <label for="prevention_recommendations">Рекомендации по предотвращению:</label>
    <textarea name="prevention_recommendations" id="prevention_recommendations">{{ incident.prevention_recommendations }}</textarea>

    <button type="submit">Отправить на проверку</button>
</form>
{% endblock %}