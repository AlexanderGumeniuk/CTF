{% extends "base_competition.html" %}

{% block content %}
<div class="container">
    <h1>{{ incident.title }}</h1>
    <p><strong>Описание:</strong> {{ incident.description }}</p>
    <p><strong>Статус:</strong> {{ incident.status }}</p>
    <p><strong>Создатель:</strong> {{ incident.user.username }}</p>
    <p><strong>Время начала:</strong> {{ incident.start_time.strftime('%Y-%m-%d %H:%M') }}</p>
    <p><strong>Время окончания:</strong> {{ incident.end_time.strftime('%Y-%m-%d %H:%M') }}</p>
    <p><strong>IP-адрес источника:</strong> {{ incident.source_ip }}</p>
    <p><strong>Порт источника:</strong> {{ incident.source_port }}</p>
    <p><strong>IP-адрес назначения:</strong> {{ incident.destination_ip }}</p>
    <p><strong>Порт назначения:</strong> {{ incident.destination_port }}</p>
    <p><strong>Тип события:</strong> {{ incident.event_type }}</p>
    <p><strong>Связанные FQDN:</strong> {{ incident.related_fqdn }}</p>
    <p><strong>Связанные DNS-имена:</strong> {{ incident.related_dns }}</p>
    <p><strong>IOC (Indicators of Compromise):</strong> {{ incident.ioc }}</p>
    <p><strong>Хэш:</strong> {{ incident.hash_value }}</p>
    <p><strong>ID события по матрице MITRE:</strong> {{ incident.mitre_id }}</p>
    <p><strong>ID события в SIEM:</strong> {{ incident.siem_id }}</p>
    <p><strong>Ссылка на событие в SIEM:</strong> <a href="{{ incident.siem_link }}" target="_blank">{{ incident.siem_link }}</a></p>

    {% if incident.screenshots %}
    <div class="screenshots-container">
        <h2>Скриншоты</h2>
        <div class="screenshot-grid">
            {% for screenshot in incident.screenshots %}
            <div class="screenshot-item">
                <img src="{{ url_for('static', filename='uploads/images/' + screenshot) }}" alt="Скриншот">
            </div>
            {% endfor %}
        </div>
    </div>
    {% else %}
    <p>Скриншоты отсутствуют.</p>
    {% endif %}
</div>
{% endblock %}
